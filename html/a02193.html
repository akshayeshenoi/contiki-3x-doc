<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Contiki 3.x: platform/econotag/apps/ecc/ecc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Contiki 3.x
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a02193.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ecc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><pre class="fragment"> Calculations on elliptic curve secp256r1</pre>  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="a02193_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afd8ffb803b9c733e2b6c62f48fa6ab9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02193.html#afd8ffb803b9c733e2b6c62f48fa6ab9d">ecc_is_valid_key</a>(key,  order)&#160;&#160;&#160;(<a class="el" href="a02193.html#aa9e81d64072b9813900898033d48b1d7">ecc_compare</a>(order, key) == 1)</td></tr>
<tr class="memdesc:afd8ffb803b9c733e2b6c62f48fa6ab9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a (random) number is valid as scalar on elliptic curve secp256r1.  <a href="#afd8ffb803b9c733e2b6c62f48fa6ab9d">More...</a><br /></td></tr>
<tr class="separator:afd8ffb803b9c733e2b6c62f48fa6ab9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa9e81d64072b9813900898033d48b1d7"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02193.html#aa9e81d64072b9813900898033d48b1d7">ecc_compare</a> (const uint32_t *a, const uint32_t *b)</td></tr>
<tr class="memdesc:aa9e81d64072b9813900898033d48b1d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares the value of a with the value of b.  <a href="#aa9e81d64072b9813900898033d48b1d7">More...</a><br /></td></tr>
<tr class="separator:aa9e81d64072b9813900898033d48b1d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5587d0bb39cb658b3053de519e63b444"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02193.html#a5587d0bb39cb658b3053de519e63b444">ecc_ec_mult</a> (uint32_t *resultx, uint32_t *resulty, const uint32_t *px, const uint32_t *py, const uint32_t *secret)</td></tr>
<tr class="memdesc:a5587d0bb39cb658b3053de519e63b444"><td class="mdescLeft">&#160;</td><td class="mdescRight">ECC scalar multiplication on elliptic curve secp256r1.  <a href="#a5587d0bb39cb658b3053de519e63b444">More...</a><br /></td></tr>
<tr class="separator:a5587d0bb39cb658b3053de519e63b444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment"> Calculations on elliptic curve secp256r1</pre> <p>This is a efficient ECC implementation on the secp256r1 curve for 32 Bit CPU architectures. It provides basic operations on the secp256r1 curve and support for ECDH and ECDSA.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Schmertmann <a href="#" onclick="location.href='mai'+'lto:'+'Sma'+'ll'+'Lar'+'s@'+'t-o'+'nl'+'ine'+'.d'+'e'; return false;">Small<span style="display: none;">.nosp@m.</span>Lars<span style="display: none;">.nosp@m.</span>@t-on<span style="display: none;">.nosp@m.</span>line<span style="display: none;">.nosp@m.</span>.de</a> Jens Trillmann <a href="#" onclick="location.href='mai'+'lto:'+'jtr'+'il'+'lma'+'@i'+'nfo'+'rm'+'ati'+'k.'+'uni'+'-b'+'rem'+'en'+'.de'; return false;">jtril<span style="display: none;">.nosp@m.</span>lma@<span style="display: none;">.nosp@m.</span>infor<span style="display: none;">.nosp@m.</span>mati<span style="display: none;">.nosp@m.</span>k.uni<span style="display: none;">.nosp@m.</span>-bre<span style="display: none;">.nosp@m.</span>men.d<span style="display: none;">.nosp@m.</span>e</a> </dd></dl>

<p>Definition in file <a class="el" href="a02193_source.html">ecc.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="afd8ffb803b9c733e2b6c62f48fa6ab9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ecc_is_valid_key</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">key, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">order&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="a02193.html#aa9e81d64072b9813900898033d48b1d7">ecc_compare</a>(order, key) == 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if a (random) number is valid as scalar on elliptic curve secp256r1. </p>
<p>A (random) number is only usable as scalar on elliptic curve secp256r1 if it is lower than the order of the curve. For the check, you need to provide the order of elliptic curve secp256r1.</p>
<p>uint32_t order[8] = {0xFC632551, 0xF3B9CAC2, 0xA7179E84, 0xBCE6FAAD, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000, 0xFFFFFFFF};</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The (random) number to check for usability </td></tr>
    <tr><td class="paramname">order</td><td>The order of elliptic curve secp256r1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if key is valid </dd></dl>

<p>Definition at line <a class="el" href="a02193_source.html#l00068">68</a> of file <a class="el" href="a02193_source.html">ecc.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa9e81d64072b9813900898033d48b1d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t ecc_compare </td>
          <td>(</td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares the value of a with the value of b. </p>
<p>This function is only public because its needed for the macro ecc_is_valid_key. It does a comparison of two 256 bit numbers. The return values are 1, 0 or -1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First number </td></tr>
    <tr><td class="paramname">b</td><td>Second number</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a is greater than b 0 if a is equal to b -1 if a is less than b </dd></dl>

<p>Definition at line <a class="el" href="a02192_source.html#l00112">112</a> of file <a class="el" href="a02192_source.html">ecc.c</a>.</p>

<p>Referenced by <a class="el" href="a02192_source.html#l00124">ecc_ec_mult()</a>.</p>

</div>
</div>
<a class="anchor" id="a5587d0bb39cb658b3053de519e63b444"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ecc_ec_mult </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>resultx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>resulty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>px</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>py</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ECC scalar multiplication on elliptic curve secp256r1. </p>
<p>This function does a scalar multiplication on elliptic curve secp256r1. For an Elliptic curve Diffie–Hellman you need two multiplications. First one with the base point of elliptic curve secp256r1 you need to provide.</p>
<p>uint32_t base_x[8] = {0xd898c296, 0xf4a13945, 0x2deb33a0, 0x77037d81, 0x63a440f2, 0xf8bce6e5, 0xe12c4247, 0x6b17d1f2}; uint32_t base_y[8] = {0x37bf51f5, 0xcbb64068, 0x6b315ece, 0x2bce3357, 0x7c0f9e16, 0x8ee7eb4a, 0xfe1a7f9b, 0x4fe342e2};</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resultx</td><td>Pointer to memory to store the x-coordinate of the result </td></tr>
    <tr><td class="paramname">resulty</td><td>Pointer to memory to store the y-coordinate of the result </td></tr>
    <tr><td class="paramname">px</td><td>x-coordinate of the point to multiply with scalar </td></tr>
    <tr><td class="paramname">py</td><td>y-coordinate of the point to multiply with scalar </td></tr>
    <tr><td class="paramname">secret</td><td>Scalar for multiplication with elliptic curve point </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a02192_source.html#l00124">124</a> of file <a class="el" href="a02192_source.html">ecc.c</a>.</p>

<p>References <a class="el" href="a01846_source.html#l00194">__attribute__</a>, and <a class="el" href="a02192_source.html#l00112">ecc_compare()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c5a52a81292cf9a5167198f4f346d6d9.html">platform</a></li><li class="navelem"><a class="el" href="dir_84b6b6195067a283c60ded99717e803d.html">econotag</a></li><li class="navelem"><a class="el" href="dir_c5b76835f58e4005fe0027c04fb37c22.html">apps</a></li><li class="navelem"><a class="el" href="dir_f8d31077df98e576b5e75508e60e912e.html">ecc</a></li><li class="navelem"><a class="el" href="a02193.html">ecc.h</a></li>
    <li class="footer">Generated on Fri Mar 11 2022 12:06:07 for Contiki 3.x by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
