<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Contiki 3.x: Implicit network time synchronization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Contiki 3.x
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a02570.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Implicit network time synchronization<div class="ingroups"><a class="el" href="a02853.html">Contiki system</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This crude and simple network time synchronization module synchronizes clocks of all nodes in a network.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3cbbb613755e88445d1430660ee4f8cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#ga3cbbb613755e88445d1430660ee4f8cf">timesynch_init</a> (void)</td></tr>
<tr class="memdesc:ga3cbbb613755e88445d1430660ee4f8cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the timesynch module.  <a href="#ga3cbbb613755e88445d1430660ee4f8cf">More...</a><br /></td></tr>
<tr class="separator:ga3cbbb613755e88445d1430660ee4f8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1ba1eca70ee84e0660b755ea45deef5"><td class="memItemLeft" align="right" valign="top">rtimer_clock_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#gad1ba1eca70ee84e0660b755ea45deef5">timesynch_time</a> (void)</td></tr>
<tr class="memdesc:gad1ba1eca70ee84e0660b755ea45deef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time-synchronized time.  <a href="#gad1ba1eca70ee84e0660b755ea45deef5">More...</a><br /></td></tr>
<tr class="separator:gad1ba1eca70ee84e0660b755ea45deef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae47952b50b11e4803cbb48f59d3d4112"><td class="memItemLeft" align="right" valign="top">rtimer_clock_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#gae47952b50b11e4803cbb48f59d3d4112">timesynch_time_to_rtimer</a> (rtimer_clock_t synched_time)</td></tr>
<tr class="memdesc:gae47952b50b11e4803cbb48f59d3d4112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time-synchronized time, suitable for use with the rtimer module.  <a href="#gae47952b50b11e4803cbb48f59d3d4112">More...</a><br /></td></tr>
<tr class="separator:gae47952b50b11e4803cbb48f59d3d4112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97b1f689b39206c63740982ebf3ca1c5"><td class="memItemLeft" align="right" valign="top">rtimer_clock_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#ga97b1f689b39206c63740982ebf3ca1c5">timesynch_rtimer_to_time</a> (rtimer_clock_t rtimer_time)</td></tr>
<tr class="memdesc:ga97b1f689b39206c63740982ebf3ca1c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the synchronized equivalent of an rtimer time.  <a href="#ga97b1f689b39206c63740982ebf3ca1c5">More...</a><br /></td></tr>
<tr class="separator:ga97b1f689b39206c63740982ebf3ca1c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc1d155e0df415d5d7ece04ebfb7a7d1"><td class="memItemLeft" align="right" valign="top">rtimer_clock_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#gadc1d155e0df415d5d7ece04ebfb7a7d1">timesynch_offset</a> (void)</td></tr>
<tr class="memdesc:gadc1d155e0df415d5d7ece04ebfb7a7d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time-synchronized offset from the rtimer clock, which is used mainly for debugging.  <a href="#gadc1d155e0df415d5d7ece04ebfb7a7d1">More...</a><br /></td></tr>
<tr class="separator:gadc1d155e0df415d5d7ece04ebfb7a7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f55230ffa3d038b84bec769faa11426"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#ga8f55230ffa3d038b84bec769faa11426">timesynch_authority_level</a> (void)</td></tr>
<tr class="memdesc:ga8f55230ffa3d038b84bec769faa11426"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current authority level of the time-synchronized time.  <a href="#ga8f55230ffa3d038b84bec769faa11426">More...</a><br /></td></tr>
<tr class="separator:ga8f55230ffa3d038b84bec769faa11426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a498e965d3fb88281bee77efc30fcc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a02570.html#ga4a498e965d3fb88281bee77efc30fcc5">timesynch_set_authority_level</a> (int level)</td></tr>
<tr class="memdesc:ga4a498e965d3fb88281bee77efc30fcc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the authority level of the current time.  <a href="#ga4a498e965d3fb88281bee77efc30fcc5">More...</a><br /></td></tr>
<tr class="separator:ga4a498e965d3fb88281bee77efc30fcc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This crude and simple network time synchronization module synchronizes clocks of all nodes in a network. </p>
<p>The time synchronization is implicit in that no explicit time synchronization messages are sent: the module relies on the underlying network device driver to timestamp all radio messages, both outgoing and incoming. The code currently only works on the Tmote Sky platform and the cc2420 driver.</p>
<p>Every node has an authority level, which is included in every outgoing packet. If a message is received from a node with higher authority (lower authority number), the node adjusts its clock towards the clock of the sending node.</p>
<p>The timesynch module is implemented as a meta-MAC protocol, so that the module is invoked for every incoming packet. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga8f55230ffa3d038b84bec769faa11426"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int timesynch_authority_level </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current authority level of the time-synchronized time. </p>
<dl class="section return"><dt>Returns</dt><dd>The current authority level of the time-synchronized time <pre class="fragment">        This function returns the current authority level of
        the time-synchronized time. A node with a lower
        authority level is defined to have a better notion of
        time than a node with a higher authority
        level. Authority level 0 is best and should be used by
        a sink node that has a connection to an outside,
        "true", clock source.</pre> </dd></dl>

</div>
</div>
<a class="anchor" id="ga3cbbb613755e88445d1430660ee4f8cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timesynch_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the timesynch module. </p>
<p>This function initializes the timesynch module. This function must not be called before <a class="el" href="a02850.html#gaeb36eb1e9d4c51fae6ad6c96900b9602" title="Initialize Rime. ">rime_init()</a>. </p>

<p>Referenced by <a class="el" href="a02246_source.html#l00288">main()</a>, and <a class="el" href="a02330_source.html#l00123">uip_log()</a>.</p>

</div>
</div>
<a class="anchor" id="gadc1d155e0df415d5d7ece04ebfb7a7d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rtimer_clock_t timesynch_offset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time-synchronized offset from the rtimer clock, which is used mainly for debugging. </p>
<dl class="section return"><dt>Returns</dt><dd>The current time-synchronized offset from the rtimer clock <pre class="fragment">        This function returns the current time-synchronized
        offset from the rtimer arch clock. This is mainly
        useful for debugging the timesynch module.</pre> </dd></dl>

</div>
</div>
<a class="anchor" id="ga97b1f689b39206c63740982ebf3ca1c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rtimer_clock_t timesynch_rtimer_to_time </td>
          <td>(</td>
          <td class="paramtype">rtimer_clock_t&#160;</td>
          <td class="paramname"><em>rtimer_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the synchronized equivalent of an rtimer time. </p>
<dl class="section return"><dt>Returns</dt><dd>The synchronized equivalent of an rtimer time <pre class="fragment">        This function returns the time synchronized equivalent
        time corresponding to a (local) rtimer time.</pre> </dd></dl>

</div>
</div>
<a class="anchor" id="ga4a498e965d3fb88281bee77efc30fcc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timesynch_set_authority_level </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the authority level of the current time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>The authority level </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="a02246_source.html#l00288">main()</a>, and <a class="el" href="a02330_source.html#l00123">uip_log()</a>.</p>

</div>
</div>
<a class="anchor" id="gad1ba1eca70ee84e0660b755ea45deef5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rtimer_clock_t timesynch_time </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time-synchronized time. </p>
<dl class="section return"><dt>Returns</dt><dd>The current time-synchronized time <pre class="fragment">        This function returns the current time-synchronized
        time.</pre> </dd></dl>

</div>
</div>
<a class="anchor" id="gae47952b50b11e4803cbb48f59d3d4112"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rtimer_clock_t timesynch_time_to_rtimer </td>
          <td>(</td>
          <td class="paramtype">rtimer_clock_t&#160;</td>
          <td class="paramname"><em>synched_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time-synchronized time, suitable for use with the rtimer module. </p>
<dl class="section return"><dt>Returns</dt><dd>The current time-synchronized rtimer time <pre class="fragment">        This function returns the (local) rtimer-equivalent
        time corresponding to the current time-synchronized
        (global) time. The rtimer-equivalent time is used for
        setting rtimer timers that are synchronized to other
        nodes in the network.</pre> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Mar 11 2022 12:06:08 for Contiki 3.x by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
